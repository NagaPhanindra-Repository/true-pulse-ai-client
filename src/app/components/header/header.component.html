<header class="main-header">
  <div class="header-content">
    <a class="brand" routerLink="/">
      <img src="assets/logo.svg" alt="TruePulse AI Logo" class="brand-logo" />
      <span class="brand-name">TruePulse <span class="ai-gradient">AI</span></span>
    </a>
    <!-- Navigation links, only for logged in users -->
    <nav class="nav-links" [class.mobile-open]="showMobileNav" *ngIf="isLoggedIn">
      <a routerLink="/dashboard" (click)="closeMobileNav()">Home</a>
      <a routerLink="/retros" (click)="closeMobileNav()">Retros</a>
      <a routerLink="/questions" (click)="closeMobileNav()">Questions</a>
      <a routerLink="/followers" (click)="closeMobileNav()">Followers</a>
      <a routerLink="/business" (click)="closeMobileNav()">Business</a>
      <a routerLink="/entities/create" (click)="closeMobileNav()">Create Entity</a>
      <a routerLink="/entities/my" (click)="closeMobileNav()">My Entities</a>
    </nav>
    <div class="header-actions">
      <ng-container *ngIf="!isLoggedIn; else loggedInBlock">
        <button class="login-btn" (click)="showLogin = true">Login</button>
        <button class="signup-btn" (click)="showSignUp = true">Sign Up</button>
      </ng-container>
      <ng-template #loggedInBlock>
        <button class="hamburger" (click)="toggleMobileNav()" aria-label="Open navigation">
          <span></span><span></span><span></span>
        </button>
        <div class="profile-menu-wrapper"
             (mouseenter)="toggleProfileDropdown(true)"
             (mouseleave)="toggleProfileDropdown(false)"
             (click)="toggleProfileClick()">
          <!-- Profile Picture or Initials Avatar -->
          <div class="profile-pic-wrapper">
            <img *ngIf="!showInitialsAvatar" 
                 [src]="profilePic" 
                 alt="Profile" 
                 class="profile-pic" 
                 (error)="onProfilePicError()" />
            <div *ngIf="showInitialsAvatar" 
                 class="profile-initials" 
                 [style.background]="avatarColor">
              {{ userInitials }}
            </div>
          </div>
          <span class="profile-label">
            <ng-container *ngIf="userName; else profileText">{{ userName }}</ng-container>
            <ng-template #profileText>Profile</ng-template>
          </span>
          <div class="profile-dropdown glassy-card" 
               *ngIf="showProfileDropdown"
               (mouseenter)="toggleProfileDropdown(true)"
               (mouseleave)="toggleProfileDropdown(false)"
               (click)="$event.stopPropagation()">
            <a href="#" (click)="closeProfileDropdown(); $event.preventDefault()">My Profile</a>
            <a href="#" (click)="closeProfileDropdown(); $event.preventDefault()">Settings</a>
            <a href="#" (click)="logout(); $event.preventDefault()">Logout</a>
          </div>
        </div>
      </ng-template>
    </div>
  </div>
  <div class="signup-modal" *ngIf="showSignUp">
    <div class="signup-modal-backdrop" (click)="showSignUp = false"></div>
    <div class="signup-modal-content">
      <button class="signup-modal-close" (click)="showSignUp = false">×</button>
      <app-sign-up (signupSuccess)="showSignUp = false; showLogin = true; loginSuccessMessage = $event"></app-sign-up>
    </div>
  </div>
  <div class="signup-modal" *ngIf="showLogin">
    <div class="signup-modal-backdrop" (click)="showLogin = false; loginSuccessMessage = null"></div>
    <div class="signup-modal-content">
      <button class="signup-modal-close" (click)="showLogin = false; loginSuccessMessage = null">×</button>
      <app-login-in [successMessage]="loginSuccessMessage" (closeLogin)="showLogin = false; loginSuccessMessage = null"></app-login-in>
    </div>
  </div>
</header>

